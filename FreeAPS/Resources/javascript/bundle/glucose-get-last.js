var freeaps_glucoseGetLast;(()=>{var e={6237:e=>{function o(e){return e.date||Date.parse(e.display_time)||Date.parse(e.dateString)}e.exports=function(e){for(var r=(e=e.filter((function(e){return e.glucose||e.sgv})).map((function(e){if(e.glucose=e.glucose||e.sgv,null!==e.glucose)return e})))[0],a=o(r),t=[],u=[],n=[],l=0,s=1;s<e.length;s++){if(void 0!==e[s]&&"cal"===e[s].type){l=s;break}if(void 0!==e[s]&&e[s].glucose>38&&e[s].device===r.device){var c,g=0;void 0!==(y=o(V=e[s]))&&void 0!==a?(c=Math.round((a-y)/6e4),g=(r.glucose-V.glucose)/c*5):console.error("Error: date field not found: cannot calculate avgdelta"),-2<c&&c<2.5?(r.glucose=(r.glucose+V.glucose)/2,a=(a+y)/2):2.5<c&&c<17.5?(u.push(g),2.5<c&&c<7.5&&t.push(g)):17.5<c&&c<42.5&&n.push(g)}}var d,h,i=0,v=0,f=0,p=0,M=0,_=0,b=0,w=0,k=0,x=0,S=0,D="autoISF Mod14-Debug: ";t.length>0&&(i=t.reduce((function(e,o){return e+o}))/t.length),u.length>0&&(v=u.reduce((function(e,o){return e+o}))/u.length),n.length>0&&(f=n.reduce((function(e,o){return e+o}))/n.length);var F=r.glucose,I=r.glucose,m=0;for(s=1;s<e.length;s++){var y=o(V=e[s]);if(Math.round((a-y)/6e4)-m>13)break;if(!(V.glucose>.95*I&&V.glucose<1.05*I))break;I=(F+=V.glucose)/(s+1),m=Math.round((a-y)/6e4)}h=I,d=m;p=1.05,M=1.15,_=1.4,F=0;var G,L,q=0,E=0,j=0,z=7.5;for(s=0;s<e.length;s++){if((L=(a-(y=o(V=e[s])))/6e4)>z&&7.5==z&&(p=5*-(G=(s*j-q*F)/(s*E-q*q)),z=17.5),L>z&&17.5==z&&(M=5*-(G=(s*j-q*F)/(s*E-q*q)),z=42.5),L>z&&42.5==z){_=5*-(G=(s*j-q*F)/(s*E-q*q));break}q+=L,E+=L*L,F+=V.glucose,V.glucose*V.glucose,j+=V.glucose*L}b=0,w=0,k=0,S=0,x=0;var A=0,B=0,C=0;if(e.length<=3)b=0,w=0,k=0,S=0,x=0;else{var H=0,J=0,K=0,N=0,O=0,P=0,Q=0,R=0,T=o(e[0]),U=0;for(s=0;s<e.length;s++){var V,W=((y=o(V=e[s]))-T)/1e3;if(-W>2820)break;if(W<U-450){s<3&&(b=-U/60,w=0,k=0,S=0,x=0);break}U=W;var X=V.glucose;J+=W,K+=Math.pow(W,2),N+=Math.pow(W,3),O+=Math.pow(W,4),H+=X,P+=W*X,Q+=Math.pow(W,2)*X;var Y=s+1,Z=0,$=0,ee=0,oe=0;if(Y>3&&(Z=O*(K*Y-J*J)-N*(N*Y-J*K)+K*(N*J-K*K),$=Q*(K*Y-J*J)-P*(N*Y-J*K)+H*(N*J-K*K),ee=O*(P*Y-H*J)-N*(Q*Y-H*K)+K*(Q*J-P*K),oe=O*(K*H-J*P)-N*(N*H-J*Q)+K*(N*P-K*Q)),0!=Z){var re=$/Z;G=ee/Z;for(var ae=oe/Z,te=H/Y,ue=0,ne=0,le=0;le<=s;le++){var se=e[le],ce=o(se);ue+=Math.pow(se.glucose-te,2);var ge=(ce-T)/1e3;ne+=Math.pow(se.glucose-re*Math.pow(ge,2)-G*ge-ae,2)}x=.64;0!=ue&&(x=1-ne/ue),Y>3&&x>R&&(R=x,b=-W/60,w=-(re*Math.pow(-300,2)-5*G*60),k=re*Math.pow(300,2)+5*G*60,S=2*re*300*300,A=re,B=G,C=ae)}}D+="coeffs=("+A+" / "+B+" / "+C+"); bg date="+T+"; "}return D+="Slopes=("+p+" / "+M+" / "+_+"); ",{delta:Math.round(100*i)/100,glucose:Math.round(100*r.glucose)/100,noise:Math.round(r.noise),short_avgdelta:Math.round(100*v)/100,long_avgdelta:Math.round(100*f)/100,autoISF_average:Math.round(100*h)/100,autoISF_duration:Math.round(100*d)/100,dura_p:Math.round(100*b)/100,delta_pl:Math.round(100*w)/100,delta_pn:Math.round(100*k)/100,bg_acceleration:Math.round(100*S)/100,r_squ:Math.round(100*x)/100,pp_debug:D,date:a,last_cal:l,device:r.device}}}},o={};var r=function r(a){var t=o[a];if(void 0!==t)return t.exports;var u=o[a]={exports:{}};return e[a](u,u.exports,r),u.exports}(6237);freeaps_glucoseGetLast=r})();